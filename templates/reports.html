{% extends 'base.html' %}

{% block title %}Rapports - {{ site_name }}{% endblock %}
{% block page_title %}Rapports et statistiques{% endblock %}
{% block page_subtitle %}Analysez vos performances et suivez votre activité{% endblock %}

{% block content %}

<!-- Period Selector -->
<div class="mb-6 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
    <div x-data="{ period: 'month' }" class="flex space-x-2">
        <button @click="period = 'week'"
                :class="period === 'week' ? 'bg-primary-600 text-white' : 'bg-white text-gray-700 hover:bg-gray-50'"
                class="px-4 py-2 text-sm font-medium border border-gray-300 rounded-lg transition-all">
            Cette semaine
        </button>
        <button @click="period = 'month'"
                :class="period === 'month' ? 'bg-primary-600 text-white' : 'bg-white text-gray-700 hover:bg-gray-50'"
                class="px-4 py-2 text-sm font-medium border border-gray-300 rounded-lg transition-all">
            Ce mois
        </button>
        <button @click="period = 'year'"
                :class="period === 'year' ? 'bg-primary-600 text-white' : 'bg-white text-gray-700 hover:bg-gray-50'"
                class="px-4 py-2 text-sm font-medium border border-gray-300 rounded-lg transition-all">
            Cette année
        </button>
    </div>

    <button class="flex items-center px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 shadow-sm">
        <i class="fas fa-download mr-2"></i>
        Exporter le rapport
    </button>
</div>

<!-- Revenue Overview -->
<div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
    <div class="lg:col-span-2 bg-white rounded-xl shadow-sm border border-gray-200 p-6">
        <div class="flex items-center justify-between mb-6">
            <h2 class="text-lg font-bold text-gray-900">Évolution du chiffre d'affaires</h2>
            <div class="flex space-x-2">
                <button class="px-3 py-1 text-xs font-medium text-primary-600 bg-primary-50 rounded-lg">
                    Facturé
                </button>
                <button class="px-3 py-1 text-xs font-medium text-gray-600 hover:bg-gray-50 rounded-lg">
                    Encaissé
                </button>
            </div>
        </div>

        <!-- Chart Placeholder -->
        <div class="h-80 bg-gradient-to-br from-gray-50 to-gray-100 rounded-lg flex items-center justify-center">
            <div class="text-center">
                <i class="fas fa-chart-line text-gray-300 text-6xl mb-4"></i>
                <p class="text-gray-500">Graphique d'évolution du CA</p>
                <p class="text-xs text-gray-400 mt-2">Intégration Chart.js recommandée</p>
            </div>
        </div>
    </div>

    <div class="space-y-6">
        <!-- Monthly Summary -->
        <div class="bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl border border-blue-200 p-6">
            <div class="flex items-center justify-between mb-4">
                <h3 class="text-sm font-semibold text-blue-900">Ce mois</h3>
                <div class="w-10 h-10 bg-blue-200 rounded-lg flex items-center justify-center">
                    <i class="fas fa-calendar-alt text-blue-600"></i>
                </div>
            </div>
            <div class="space-y-3">
                <div>
                    <p class="text-xs text-blue-700 mb-1">Chiffre d'affaires</p>
                    <p class="text-2xl font-bold text-blue-900">{{ monthly_revenue|floatformat:2 }} €</p>
                </div>
                <div class="pt-3 border-t border-blue-200">
                    <div class="flex justify-between items-center mb-2">
                        <span class="text-xs text-blue-700">Progression</span>
                        <span class="text-sm font-bold text-blue-900">+12.5%</span>
                    </div>
                    <div class="w-full bg-blue-200 rounded-full h-2">
                        <div class="bg-blue-600 h-2 rounded-full" style="width: 75%"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Quick Stats -->
        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
            <h3 class="text-sm font-semibold text-gray-900 mb-4">Statistiques rapides</h3>
            <div class="space-y-4">
                <div class="flex items-center justify-between">
                    <div class="flex items-center">
                        <div class="w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center mr-3">
                            <i class="fas fa-file-invoice text-green-600 text-sm"></i>
                        </div>
                        <span class="text-sm text-gray-600">Factures</span>
                    </div>
                    <span class="text-lg font-bold text-gray-900">{{ monthly_invoices }}</span>
                </div>

                <div class="flex items-center justify-between">
                    <div class="flex items-center">
                        <div class="w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center mr-3">
                            <i class="fas fa-users text-purple-600 text-sm"></i>
                        </div>
                        <span class="text-sm text-gray-600">Nouveaux clients</span>
                    </div>
                    <span class="text-lg font-bold text-gray-900">{{ monthly_clients }}</span>
                </div>

                <div class="flex items-center justify-between">
                    <div class="flex items-center">
                        <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center mr-3">
                            <i class="fas fa-shopping-cart text-blue-600 text-sm"></i>
                        </div>
                        <span class="text-sm text-gray-600">Commandes</span>
                    </div>
                    <span class="text-lg font-bold text-gray-900">45</span>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Detailed Stats -->
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
        <div class="flex items-center justify-between mb-4">
            <div class="w-12 h-12 bg-gradient-to-br from-green-400 to-green-600 rounded-xl flex items-center justify-center shadow-lg">
                <i class="fas fa-euro-sign text-white text-xl"></i>
            </div>
            <span class="px-2 py-1 bg-green-100 text-green-700 text-xs font-semibold rounded-full">
                +8.2%
            </span>
        </div>
        <h3 class="text-sm text-gray-500 mb-1">Revenu total</h3>
        <p class="text-2xl font-bold text-gray-900">125,450 €</p>
        <p class="text-xs text-gray-500 mt-2">vs mois précédent</p>
    </div>

    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
        <div class="flex items-center justify-between mb-4">
            <div class="w-12 h-12 bg-gradient-to-br from-blue-400 to-blue-600 rounded-xl flex items-center justify-center shadow-lg">
                <i class="fas fa-file-invoice text-white text-xl"></i>
            </div>
            <span class="px-2 py-1 bg-blue-100 text-blue-700 text-xs font-semibold rounded-full">
                +15
            </span>
        </div>
        <h3 class="text-sm text-gray-500 mb-1">Factures émises</h3>
        <p class="text-2xl font-bold text-gray-900">187</p>
        <p class="text-xs text-gray-500 mt-2">ce mois-ci</p>
    </div>

    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
        <div class="flex items-center justify-between mb-4">
            <div class="w-12 h-12 bg-gradient-to-br from-purple-400 to-purple-600 rounded-xl flex items-center justify-center shadow-lg">
                <i class="fas fa-users text-white text-xl"></i>
            </div>
            <span class="px-2 py-1 bg-purple-100 text-purple-700 text-xs font-semibold rounded-full">
                +3
            </span>
        </div>
        <h3 class="text-sm text-gray-500 mb-1">Clients actifs</h3>
        <p class="text-2xl font-bold text-gray-900">42</p>
        <p class="text-xs text-gray-500 mt-2">nouveaux ce mois</p>
    </div>

    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
        <div class="flex items-center justify-between mb-4">
            <div class="w-12 h-12 bg-gradient-to-br from-orange-400 to-orange-600 rounded-xl flex items-center justify-center shadow-lg">
                <i class="fas fa-chart-line text-white text-xl"></i>
            </div>
            <span class="px-2 py-1 bg-orange-100 text-orange-700 text-xs font-semibold rounded-full">
                +12%
            </span>
        </div>
        <h3 class="text-sm text-gray-500 mb-1">Panier moyen</h3>
        <p class="text-2xl font-bold text-gray-900">670 €</p>
        <p class="text-xs text-gray-500 mt-2">par facture</p>
    </div>
</div>

<!-- Tables -->
<div class="grid grid-cols-1 lg:grid-cols-2 gap-6">

    <!-- Top Clients -->
    <div class="bg-white rounded-xl shadow-sm border border-gray-200">
        <div class="px-6 py-4 border-b border-gray-200">
            <h2 class="text-lg font-bold text-gray-900 flex items-center">
                <i class="fas fa-trophy text-yellow-500 mr-3"></i>
                Meilleurs clients
            </h2>
        </div>
        <div class="p-6">
            <div class="space-y-4">
                {% for i in "12345" %}
                <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors">
                    <div class="flex items-center flex-1">
                        <div class="flex-shrink-0 w-10 h-10 rounded-full bg-gradient-to-br from-primary-400 to-primary-600 flex items-center justify-center text-white font-bold shadow-lg">
                            {{ forloop.counter }}
                        </div>
                        <div class="ml-4">
                            <p class="text-sm font-medium text-gray-900">Client {{ forloop.counter }}</p>
                            <p class="text-xs text-gray-500">15 factures</p>
                        </div>
                    </div>
                    <div class="text-right">
                        <p class="text-sm font-bold text-gray-900">12,450 €</p>
                        <p class="text-xs text-green-600">+8%</p>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>

    <!-- Top Products -->
    <div class="bg-white rounded-xl shadow-sm border border-gray-200">
        <div class="px-6 py-4 border-b border-gray-200">
            <h2 class="text-lg font-bold text-gray-900 flex items-center">
                <i class="fas fa-star text-yellow-500 mr-3"></i>
                Produits les plus vendus
            </h2>
        </div>
        <div class="p-6">
            <div class="space-y-4">
                {% for i in "12345" %}
                <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors">
                    <div class="flex items-center flex-1">
                        <div class="flex-shrink-0 w-10 h-10 rounded-lg bg-gradient-to-br from-blue-100 to-blue-200 flex items-center justify-center">
                            <i class="fas fa-box text-blue-600"></i>
                        </div>
                        <div class="ml-4">
                            <p class="text-sm font-medium text-gray-900">Produit {{ forloop.counter }}</p>
                            <p class="text-xs text-gray-500">125 unités vendues</p>
                        </div>
                    </div>
                    <div class="text-right">
                        <p class="text-sm font-bold text-gray-900">8,750 €</p>
                        <p class="text-xs text-gray-500">Total</p>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
</div>

<!-- Payment Methods Chart -->
<div class="mt-6 bg-white rounded-xl shadow-sm border border-gray-200 p-6">
    <h2 class="text-lg font-bold text-gray-900 mb-6">Répartition des modes de paiement</h2>
    <div class="grid grid-cols-1 md:grid-cols-5 gap-4">
        <div class="text-center p-4 bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl border border-blue-200">
            <div class="w-16 h-16 bg-blue-200 rounded-full flex items-center justify-center mx-auto mb-3">
                <i class="fas fa-university text-blue-600 text-2xl"></i>
            </div>
            <p class="text-sm font-medium text-gray-900 mb-1">Virement</p>
            <p class="text-2xl font-bold text-blue-600">45%</p>
        </div>

        <div class="text-center p-4 bg-gradient-to-br from-green-50 to-green-100 rounded-xl border border-green-200">
            <div class="w-16 h-16 bg-green-200 rounded-full flex items-center justify-center mx-auto mb-3">
                <i class="fas fa-credit-card text-green-600 text-2xl"></i>
            </div>
            <p class="text-sm font-medium text-gray-900 mb-1">Carte</p>
            <p class="text-2xl font-bold text-green-600">30%</p>
        </div>

        <div class="text-center p-4 bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl border border-purple-200">
            <div class="w-16 h-16 bg-purple-200 rounded-full flex items-center justify-center mx-auto mb-3">
                <i class="fas fa-money-check text-purple-600 text-2xl"></i>
            </div>
            <p class="text-sm font-medium text-gray-900 mb-1">Chèque</p>
            <p class="text-2xl font-bold text-purple-600">15%</p>
        </div>

        <div class="text-center p-4 bg-gradient-to-br from-yellow-50 to-yellow-100 rounded-xl border border-yellow-200">
            <div class="w-16 h-16 bg-yellow-200 rounded-full flex items-center justify-center mx-auto mb-3">
                <i class="fas fa-money-bill-wave text-yellow-600 text-2xl"></i>
            </div>
            <p class="text-sm font-medium text-gray-900 mb-1">Espèces</p>
            <p class="text-2xl font-bold text-yellow-600">8%</p>
        </div>

        <div class="text-center p-4 bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl border border-gray-200">
            <div class="w-16 h-16 bg-gray-200 rounded-full flex items-center justify-center mx-auto mb-3">
                <i class="fas fa-ellipsis-h text-gray-600 text-2xl"></i>
            </div>
            <p class="text-sm font-medium text-gray-900 mb-1">Autre</p>
            <p class="text-2xl font-bold text-gray-600">2%</p>
        </div>
    </div>
</div>

{% endblock %}
